import{B}from"./Button-DIWjbb8q.js";import{d as S,r as I,c as a,u as t,o as n,w as i,e as l,t as c,f as s,b as p,a as V,N as C,a4 as z,_ as A}from"./app-DxWyC75P.js";import{N as f}from"./Alert-BXNNmmus.js";import{N as D}from"./Input-mY2gL0xN.js";const L=S({__name:"Callback",setup(R){const u=new URL(window.location.href),d=u.searchParams.get("code"),x=u.searchParams.get("state"),_=u.searchParams.get("error"),P=u.searchParams.get("error_description"),[k,m,y]=atob(x).split("::"),r=I();d&&!_&&(async()=>{const o=new URLSearchParams;o.append("client_id",k),o.append("client_secret",m),o.append("code",d),o.append("grant_type","authorization_code"),o.append("redirect_uri",y),fetch("https://www.googleapis.com/oauth2/v4/token",{method:"POST",headers:{"Content-Type":"application/x-www-form-urlencoded"},body:o}).then(e=>e.json()).then(e=>{console.log(e),r.value=e})})();function T(){var o;window.open(`/tool/google/album?access_token=${(o=r.value)==null?void 0:o.access_token}`,"_blank")}return(o,e)=>!t(d)||t(_)?(n(),a(t(f),{key:0,title:t(_)||"Error",type:"error"},{default:i(()=>[l(c(t(P)),1)]),_:1},8,["title"])):(n(),a(t(C),{key:1,vertical:"",size:"large"},{default:i(()=>{var v,b,g;return[s("p",null,[e[0]||(e[0]=s("b",null,"client_id: ",-1)),l(c(t(k)),1)]),s("p",null,[e[1]||(e[1]=s("b",null,"client_secret: ",-1)),l(c(t(m)),1)]),s("p",null,[e[2]||(e[2]=s("b",null,"redirect_uri: ",-1)),l(c(t(y)),1)]),(v=r.value)!=null&&v.error||(b=r.value)!=null&&b.error_description?(n(),a(t(f),{key:0,title:(g=r.value)==null?void 0:g.error,type:"error"},{default:i(()=>[l(c(r.value.error_description),1)]),_:1},8,["title"])):p("",!0),V(t(C),{vertical:""},{default:i(()=>{var w,N,h;return[e[5]||(e[5]=s("b",null,"refresh_token:",-1)),r.value?p("",!0):(n(),a(t(z),{key:0})),(w=r.value)!=null&&w.refresh_token?(n(),a(t(D),{key:1,type:"textarea",autosize:"",readonly:"",value:r.value.refresh_token},null,8,["value"])):(N=r.value)!=null&&N.access_token?(n(),a(t(f),{key:2,title:"Web client",type:"warning"},{default:i(()=>e[3]||(e[3]=[l(" The refresh_token is only returned once if you use a web client. ")])),_:1,__:[3]})):p("",!0),(h=r.value)!=null&&h.access_token?(n(),a(t(B),{key:3,onClick:T,block:"",type:"primary"},{default:i(()=>e[4]||(e[4]=[l("Get Album ID")])),_:1,__:[4]})):p("",!0)]}),_:1,__:[5]})]}),_:1}))}}),W=A(L,[["__scopeId","data-v-18105aea"]]);export{W as C};
